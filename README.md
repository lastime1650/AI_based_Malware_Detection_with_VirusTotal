# AI_based_Malware_Detection_with_VirusTotal
This source code is entirely based on Python3.9, based on the VirusTotal API and the pefile module, and uses the Tensorflow AI module to detect malware.

기존 pefile모듈 기반 정적분석과 Virus_Total API를 결합하여 데이터세트를 생성하고, AI 모델을 구축하는 프로젝트입니다.
또한 CSV의 접근성을 높이기 위해, Parsing_CSV.py를 사용하여 보다 쉽게 CSV파일을 추가,가져오기,바꾸기가 가능합니다. 

---

# 어떻게 구성되어 있는가?

## **1. NEW_AI_instance.py([MAIN/NEW_AI_instance.py](https://github.com/lastime1650/AI_based_Malware_Detection_with_VirusTotal/blob/main/MAIN/NEW_AI_instance.py))**
  
시작점이 되는 모듈이며 사용하려는 경우, 최초시 인스턴스를 만들고 **Start_Train()** 

https://github.com/lastime1650/AI_based_Malware_Detection_with_VirusTotal/blob/a9f79c65bc152ef235aa736d988563e4a194f74b/MAIN/NEW_AI_instance.py#L44

메서드를 먼저 호출하세요.

그런 다음, DISK에 저장된 X,y,Scaler,model

**X**

https://github.com/lastime1650/AI_based_Malware_Detection_with_VirusTotal/blob/bbe22880a5a6a545af15c24f09df717763e8c572/MAIN/Make_X_only_EXE.py#L267

**y**

https://github.com/lastime1650/AI_based_Malware_Detection_with_VirusTotal/blob/bbe22880a5a6a545af15c24f09df717763e8c572/MAIN/Make_X_only_EXE.py#L270

**Scaler**

https://github.com/lastime1650/AI_based_Malware_Detection_with_VirusTotal/blob/bbe22880a5a6a545af15c24f09df717763e8c572/MAIN/NEW_AI_instance.py#L129

**Model**

https://github.com/lastime1650/AI_based_Malware_Detection_with_VirusTotal/blob/bbe22880a5a6a545af15c24f09df717763e8c572/MAIN/NEW_AI_instance.py#L118

기반으로 Start_Prediction() 호출

**Start_Prediction()**

https://github.com/lastime1650/AI_based_Malware_Detection_with_VirusTotal/blob/bbe22880a5a6a545af15c24f09df717763e8c572/MAIN/NEW_AI_instance.py#L134

후 X데이터를 구축하고 예측할 수 있습니다.

<br/><br/>


## **2. PE_IMAGE_SIGNATRUEs.py([MAIN/PE_IMAGE_SIGNATRUEs.py](https://github.com/lastime1650/AI_based_Malware_Detection_with_VirusTotal/blob/main/MAIN/PE_IMAGE_SIGNATRUEs.py))**

EXE실행프로그램을 pefile모듈을 이용하여 시그니처 특성을 뽑아, X데이터의 일부를 생성합니다.

크게 **2가지**의 함수로 이루어져 있습니다.

**[1/2]DLL,API,SECTION 추출하는 함수**

https://github.com/lastime1650/AI_based_Malware_Detection_with_VirusTotal/blob/411fefabadbcc6941f4d505b082cf449da118e43/MAIN/PE_IMAGE_SIGNATRUEs.py#L86

**[2/2]PE헤더를 기반으로 추출하는 함수**

https://github.com/lastime1650/AI_based_Malware_Detection_with_VirusTotal/blob/411fefabadbcc6941f4d505b082cf449da118e43/MAIN/PE_IMAGE_SIGNATRUEs.py#L120

<br/><br/>

## **3. Make_X_only_EXE.py([MAIN/Make_X_only_EXE.py](https://github.com/lastime1650/AI_based_Malware_Detection_with_VirusTotal/blob/main/MAIN/Make_X_only_EXE.py))**

NEW_AI_instance.py에서 호출받는 함수들입니다. EXE프로그램(Path) 1개당 X데이터를 생산하는 작업을 합니다. 

크게 **3가지** 함수가 존재합니다.

**[1/3]예측을 위한 X데이터 생성 함수**

https://github.com/lastime1650/AI_based_Malware_Detection_with_VirusTotal/blob/12bf8ee23093a36a911784f94d6201eb7022830c/MAIN/Make_X_only_EXE.py#L28

**[2/3]훈련을 위한 X,y데이터 생성 함수**

https://github.com/lastime1650/AI_based_Malware_Detection_with_VirusTotal/blob/12bf8ee23093a36a911784f94d6201eb7022830c/MAIN/Make_X_only_EXE.py#L117

**[3/3]y데이터, one-hot 인코드를 생성하는 함수**

https://github.com/lastime1650/AI_based_Malware_Detection_with_VirusTotal/blob/12bf8ee23093a36a911784f94d6201eb7022830c/MAIN/Make_X_only_EXE.py#L11

<br/><br/>

## **3. virus_total_api.py([MAIN/virus_total_api.py](https://github.com/lastime1650/AI_based_Malware_Detection_with_VirusTotal/blob/main/MAIN/virus_total_api.py))**

<br/><br/>

## **4. Vt_analyse_data_to_DeepLearning_data.py([Vt_analyse_data_to_DeepLearning_data.py](https://github.com/lastime1650/AI_based_Malware_Detection_with_VirusTotal/blob/main/MAIN/Vt_analyse_data_to_DeepLearning_data.py))**

<br/><br/>

## **5. Model_Configure.py([MAIN/Model_Configure.py](https://github.com/lastime1650/AI_based_Malware_Detection_with_VirusTotal/blob/main/MAIN/Model_Configure.py))**

<br/><br/>

## **6. Parsing_CSV.py([MAIN/Parsing_CSV.py](https://github.com/lastime1650/AI_based_Malware_Detection_with_VirusTotal/blob/main/MAIN/Parsing_CSV.py))**

<br/><br/>



### **8. NEW_ai_malicious_exe_with_Vt.py([MAIN/NEW_ai_malicious_exe_with_Vt.py](https://github.com/lastime1650/AI_based_Malware_Detection_with_VirusTotal/blob/main/MAIN/NEW_ai_malicious_exe_with_Vt.py))**

<br/><br/>

